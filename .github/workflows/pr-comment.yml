name: PR Auto Comment

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - name: Welcome Comment on PR
        if: github.event.action == 'opened'
        uses: actions/github-script@v6
        with:
          script: |
            const { owner, repo } = context.repo;
            const { number: issue_number } = context.issue;
            const { login: author } = context.payload.pull_request.user;

            const welcomeMessage = `## ğŸ‰ Pull Request ìƒì„±ì„ í™˜ì˜í•©ë‹ˆë‹¤!

            ì•ˆë…•í•˜ì„¸ìš” @${author}ë‹˜! PRì„ ìƒì„±í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.

            ### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸
            PRì´ ë¨¸ì§€ë˜ê¸° ì „ì— ë‹¤ìŒ ì‚¬í•­ë“¤ì„ í™•ì¸í•´ì£¼ì„¸ìš”:

            - [ ] ì½”ë“œê°€ í”„ë¡œì íŠ¸ ìŠ¤íƒ€ì¼ ê°€ì´ë“œë¥¼ ë”°ë¥´ê³  ìˆë‚˜ìš”?
            - [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ë‚˜ìš”?
            - [ ] ìƒˆë¡œìš´ ê¸°ëŠ¥ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ ì¶”ê°€ë˜ì—ˆë‚˜ìš”?
            - [ ] ë¬¸ì„œê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆë‚˜ìš”? (í•„ìš”í•œ ê²½ìš°)
            - [ ] ë³€ê²½ì‚¬í•­ì´ breaking changeì¸ê°€ìš”?

            ### ğŸ” ìë™ ê²€ì‚¬
            - âœ… ìë™ í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤
            - âœ… ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ê°€ ì§„í–‰ë©ë‹ˆë‹¤
            - âœ… ìë™ ë¼ë²¨ë§ì´ ì ìš©ë©ë‹ˆë‹¤

            ### ğŸ“ ë„ì›€ì´ í•„ìš”í•˜ì‹œë‚˜ìš”?
            ì§ˆë¬¸ì´ë‚˜ ë„ì›€ì´ í•„ìš”í•˜ì‹œë©´ ì–¸ì œë“ ì§€ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”!

            ---
            *ì´ ëŒ“ê¸€ì€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*`;

            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number,
              body: welcomeMessage
            });

      - name: Update Comment on Sync
        if: github.event.action == 'synchronize'
        uses: actions/github-script@v6
        with:
          script: |
            const { owner, repo } = context.repo;
            const { number: issue_number } = context.issue;

            const updateMessage = `## ğŸ”„ PRì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!

            ìƒˆë¡œìš´ ì»¤ë°‹ì´ í‘¸ì‹œë˜ì—ˆìŠµë‹ˆë‹¤. ìë™ í…ŒìŠ¤íŠ¸ê°€ ë‹¤ì‹œ ì‹¤í–‰ë©ë‹ˆë‹¤.

            **ì—…ë°ì´íŠ¸ ì‹œê°„**: ${new Date().toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' })}

            ---
            *ì´ ëŒ“ê¸€ì€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*`;

            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number,
              body: updateMessage
            });
